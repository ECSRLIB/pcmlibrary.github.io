<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PCM Library | Sample</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-7xl mx-auto">
    <h1 class="text-3xl font-bold mb-4 text-center">Phase Change Material Library</h1>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
      <input type="text" id="searchInput" placeholder="Search by name..." class="border p-2 rounded" />
      <input type="number" id="tempMin" placeholder="Min Temp (°C)" class="border p-2 rounded" />
      <input type="number" id="tempMax" placeholder="Max Temp (°C)" class="border p-2 rounded" />
      <input type="number" id="latentHeatMin" placeholder="Min Heat (kJ/kg)" class="border p-2 rounded" />
      <input type="number" id="latentHeatMax" placeholder="Max Heat (kJ/kg)" class="border p-2 rounded" />
      <select id="sortBy" class="border p-2 rounded">
        <option value="name">Sort by Name</option>
        <option value="temp">Sort by Temperature</option>
        <option value="heat">Sort by Heat of Fusion</option>
      </select>
      <button id="applyFilters" class="bg-blue-500 text-white px-4 py-2 rounded">Apply Filters</button>
      <button id="sortBtn" class="bg-green-500 text-white px-4 py-2 rounded">Sort</button>
    </div>

    <div class="flex gap-4 mb-4">
      <label><input type="checkbox" value="Inorganic" class="pcm-type" checked> Inorganic</label>
      <label><input type="checkbox" value="Salt Hydrate" class="pcm-type" checked> Salt Hydrate</label>
      <label><input type="checkbox" value="Organic" class="pcm-type" checked> Organic</label>
      <label><input type="checkbox" value="Paraffin" class="pcm-type" checked> Paraffin</label>
      <label><input type="checkbox" value="Eutectic" class="pcm-type" checked> Eutectic</label>
    </div>

    <p id="pcmCount" class="mb-4 font-semibold"></p>
    <div class="overflow-x-auto">
      <table class="table-auto w-full bg-white rounded shadow">
        <thead>
          <tr class="bg-gray-200">
            <th class="px-4 py-2">Name</th>
            <th class="px-4 py-2">Type</th>
            <th class="px-4 py-2">Temp Range (°C)</th>
            <th class="px-4 py-2">Latent Heat</th>
            <th class="px-4 py-2">Cp Solid</th>
            <th class="px-4 py-2">Cp Liquid</th>
            <th class="px-4 py-2">Density Solid</th>
            <th class="px-4 py-2">Density Liquid</th>
            <th class="px-4 py-2">Expansivity</th>
            <th class="px-4 py-2">Energy Density</th>
          </tr>
        </thead>
        <tbody id="pcmTableBody"></tbody>
      </table>
    </div>
    <p id="noResults" class="hidden text-red-500 mt-4">No matching PCMs found.</p>
  </div>

  <!-- Include Dummy PCM Data -->
  <script>
    let pcmData = [
      {
        "id": 1,
        "name": "PCM A",
        "type": "Inorganic",
        "tempMin": 20,
        "tempMax": 25,
        "heatOfFusion": 180,
        "heatCapacitySolid": 1.8,
        "heatCapacityLiquid": 2.1,
        "densitySolid": 850,
        "densityLiquid": 790,
        "expansivity": 0.3,
        "energyDensity": 170
      },
      {
        "id": 2,
        "name": "PCM B",
        "type": "Salt Hydrate",
        "tempMin": 30,
        "tempMax": 35,
        "heatOfFusion": 200,
        "heatCapacitySolid": 1.6,
        "heatCapacityLiquid": 2.0,
        "densitySolid": 900,
        "densityLiquid": 840,
        "expansivity": 0.35,
        "energyDensity": 185
      },
      {
        "id": 3,
        "name": "PCM C",
        "type": "Organic",
        "tempMin": 28,
        "tempMax": 33,
        "heatOfFusion": 150,
        "heatCapacitySolid": 2.0,
        "heatCapacityLiquid": 2.3,
        "densitySolid": 780,
        "densityLiquid": 720,
        "expansivity": 0.25,
        "energyDensity": 160
      },
      {
        "id": 4,
        "name": "PCM D",
        "type": "Paraffin",
        "tempMin": 18,
        "tempMax": 22,
        "heatOfFusion": 170,
        "heatCapacitySolid": 1.9,
        "heatCapacityLiquid": 2.2,
        "densitySolid": 820,
        "densityLiquid": 770,
        "expansivity": 0.28,
        "energyDensity": 175
      },
      {
        "id": 5,
        "name": "PCM E",
        "type": "Eutectic",
        "tempMin": 24,
        "tempMax": 29,
        "heatOfFusion": 190,
        "heatCapacitySolid": 1.7,
        "heatCapacityLiquid": 2.1,
        "densitySolid": 870,
        "densityLiquid": 810,
        "expansivity": 0.32,
        "energyDensity": 180
      }
    ];

    const pcmTableBody = document.getElementById('pcmTableBody');
    const searchInput = document.getElementById('searchInput');
    const tempMinInput = document.getElementById('tempMin');
    const tempMaxInput = document.getElementById('tempMax');
    const latentHeatMinInput = document.getElementById('latentHeatMin');
    const latentHeatMaxInput = document.getElementById('latentHeatMax');
    const applyFiltersBtn = document.getElementById('applyFilters');
    const sortBy = document.getElementById('sortBy');
    const sortBtn = document.getElementById('sortBtn');
    const noResults = document.getElementById('noResults');
    const typeCheckboxes = document.querySelectorAll('.pcm-type');
    const pcmCount = document.getElementById('pcmCount');

    function displayPCMs(pcms) {
      pcmTableBody.innerHTML = '';
      noResults.classList.add('hidden');
      pcmCount.textContent = `${pcms.length} PCMs found`;
      if (!pcms || pcms.length === 0) {
        noResults.classList.remove('hidden');
        return;
      }
      pcms.forEach(pcm => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="py-2 px-4 border-b">${pcm.name}</td>
          <td class="py-2 px-4 border-b">${pcm.type}</td>
          <td class="py-2 px-4 border-b">${pcm.tempMin} - ${pcm.tempMax}</td>
          <td class="py-2 px-4 border-b">${pcm.heatOfFusion}</td>
          <td class="py-2 px-4 border-b">${pcm.heatCapacitySolid}</td>
          <td class="py-2 px-4 border-b">${pcm.heatCapacityLiquid}</td>
          <td class="py-2 px-4 border-b">${pcm.densitySolid}</td>
          <td class="py-2 px-4 border-b">${pcm.densityLiquid}</td>
          <td class="py-2 px-4 border-b">${pcm.expansivity}</td>
          <td class="py-2 px-4 border-b">${pcm.energyDensity}</td>
        `;
        pcmTableBody.appendChild(row);
      });
    }

    function filterPCMS() {
      const searchTerm = searchInput.value.toLowerCase();
      const minTemp = parseFloat(tempMinInput.value) || -Infinity;
      const maxTemp = parseFloat(tempMaxInput.value) || Infinity;
      const minLatentHeat = parseFloat(latentHeatMinInput.value) || -Infinity;
      const maxLatentHeat = parseFloat(latentHeatMaxInput.value) || Infinity;
      const selectedTypes = Array.from(typeCheckboxes).filter(cb => cb.checked).map(cb => cb.value);

      return pcmData.filter(pcm => {
        const matchesSearch = pcm.name.toLowerCase().includes(searchTerm);
        const matchesTemp = pcm.tempMin >= minTemp && pcm.tempMax <= maxTemp;
        const matchesHeat = pcm.heatOfFusion >= minLatentHeat && pcm.heatOfFusion <= maxLatentHeat;
        const matchesType = selectedTypes.includes(pcm.type);
        return matchesSearch && matchesTemp && matchesHeat && matchesType;
      });
    }

    function sortPCMS(pcms, sortByValue) {
      return [...pcms].sort((a, b) => {
        switch (sortByValue) {
          case 'name': return a.name.localeCompare(b.name);
          case 'temp': return a.tempMin - b.tempMin;
          case 'heat': return b.heatOfFusion - a.heatOfFusion;
          default: return 0;
        }
      });
    }

    applyFiltersBtn.addEventListener('click', () => {
      const filtered = filterPCMS();
      displayPCMs(sortPCMS(filtered, sortBy.value));
    });

    sortBtn.addEventListener('click', () => {
      const filtered = filterPCMS();
      const sorted = sortPCMS(filtered, sortBy.value);
      displayPCMs(sorted);
    });

    // Initial display
    displayPCMs(pcmData);
  </script>
</body>
</html>
